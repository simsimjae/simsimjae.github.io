{"componentChunkName":"component---src-components-templates-page-template-js","path":"/posts/TIL/9","result":{"data":{"markdownRemark":{"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1005px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5d30f7b9876bd0bc975fce38bb2dc926/af5bd/2020_01_23_11_36_00.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.57213930348259%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABhElEQVQoz4VSy0rDQBTtn+nOlTtXuvEzCq4LRUq7kbrQErAbsXQTEUofGIiE0gfGijWFikps2kIfSUOaNE1ynA4dKzbggcOdO3M5M3PujYAgCAL8hk/yIIT/YVUT+SkkURnomNkuS7fg+z76/T5kWYZhGGi329A0je4zRFjhCS9j//wex1cSPsYmPXRcj1ywwGLp0VzXdUiShGg0imQyiXQ6jXg8DkEQ4DjORrDxOcJOqoRDTsRuqohkpY3Sq4rLB4XyuvGGqTmHOTOwJOK5XI4K5vN5GjmOQ6/X2wiqUwtHRGzvrIKDCwF3zypuiIisjqDpFt5HBjxigSw/IpFIIBaLQRRFKsjzPCaTCSUV9NdmPX2NcVp8wW1LpU1ZCf1Fs9lENpuFoiio1+vodrvIZDIYDoc/HkfCusxgzeewLAsL14XneZSsAWw9GAyot1td9v0A3ppsr9VqoVAooFaroVqtUvPL5TI6nU7oyNAvs0XY3K1e4JLXMdq2DdM0SWOWoTO6it9Y65fbtU+tjAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2020 01 23 11 36 00\"\n        title=\"2020 01 23 11 36 00\"\n        src=\"/static/5d30f7b9876bd0bc975fce38bb2dc926/af5bd/2020_01_23_11_36_00.png\"\n        srcset=\"/static/5d30f7b9876bd0bc975fce38bb2dc926/8c2ab/2020_01_23_11_36_00.png 300w,\n/static/5d30f7b9876bd0bc975fce38bb2dc926/3f01f/2020_01_23_11_36_00.png 600w,\n/static/5d30f7b9876bd0bc975fce38bb2dc926/af5bd/2020_01_23_11_36_00.png 1005w\"\n        sizes=\"(max-width: 1005px) 100vw, 1005px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h1>yarn workspace? lerna? 비유와 예시를 통해 이해해보기</h1>\n<p>대기업에 재직중인 yarn과 lerna가 있다. lerna는 대기업 팀장이고 yarn은 lerna 팀장 밑에서 일하는 직원이다.\nlerna는 여러가지 패키지들(packages)을 관리하는 관리자이다. yarn은 각 패키지 하나하나를 관리하는 사원이다.</p>\n<p><code class=\"language-text\">lerna</code>는 관리자 역할을 오래 해왔기 때문에 각 패키지들을 배포하고 버전관리하는데 능숙하다.<br>\n<code class=\"language-text\">yarn</code>은 사원이기 때문에 각 패키지간의 의존성 관리를 잘한다.</p>\n<p><strong>lerna와 yarn을 같이 사용하는 이유가 위와 같다.</strong> 각 라이브러리가 잘하는일을 각자에게 맡긴다.\nlerna는 모노레포로 구성된 프로젝트 전체를 관리하고 yarn은 각 패키지들간의 의존성을 관리한다.\n물론 lerna로도 yarn이 할수있는일들을 할수있지만, lerna로 패키지 의존성을 관리할때 이슈가 있다고 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">lerna bootstrap --hoist</code></pre></div>\n<p>위와 같이 lerna로도 모노레포의 각 패키지의 의존성을 연결하고 공통된 의존성들은 root에서 설치 및 관리하게 할 수 있다.<br>\n하지만 리액트로 만들어진 프로젝트에서 <code class=\"language-text\">lerna bootstrap --hoist</code>로 패키지를 설치했을때 리액트 모듈을 중복해서 불러와 에러가 발생한다고 한다.\n<strong>아직은 lerna로 패키지 의존성을 관리하는게 완벽하지 않은가보다.</strong></p>\n<p><strong>그래서 많은 블로거들이 yarn과 lerna를 같이 사용해서 각자가 잘하는 부분을 맡게 하게끔 추천하고 있다.</strong></p>\n<p>다음과 같은 패키지 구조가 있다고 해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">package.json\npackages/\n    sky\n    moon\n    sun</code></pre></div>\n<p><code class=\"language-text\">moon</code>과 <code class=\"language-text\">sun</code>패키지는 <code class=\"language-text\">sky</code>패키지를 사용한다.</p>\n<p>의존성 추가를 하기 위해서 <code class=\"language-text\">moon</code>과 <code class=\"language-text\">sun</code>에서 다음과 같이 yarn 커맨드로 <code class=\"language-text\">sky</code> 패키지를 사용하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> workspace @monorepo/moon <span class=\"token function\">add</span> @monorepo/sky // moon패키지에 sky패키지를 추가\n<span class=\"token function\">yarn</span> workspace @monorepo/sun <span class=\"token function\">add</span> @monorepo/sky // sun패키지에 sky패키지를 추가</code></pre></div>\n<p>이런식으로 <code class=\"language-text\">yarn workspace</code>를 사용해서 패키지의 의존성을 설치하고 관리한다.\n그럼 <code class=\"language-text\">sky</code> 패키지가 <code class=\"language-text\">moon</code>과 <code class=\"language-text\">sun</code>패키지의 node_modules폴더 아래에 심볼릭링크로 들어가게 된다.\n심볼릭링크라는건 그냥 이해하기 쉽게 바로가기 파일이라고 생각하면 된다.</p>\n<p><strong>원본 파일인 sky패키지가 수정되어도 node_modules폴더 아래에 있는 바로가기 sky패키지도 같이 수정되게 된다.</strong>\n이런방식으로 각 npm패키지를 배포하지 않더라도 로컬 컴퓨터에서 서로 의존하고 있는 패키지들을 쉽게 수정하고 확인하고 테스트해볼수있다.\n이제 moon패키지의 node_modules에 들어있는 sky 바로가기 패키지를 moon의 <code class=\"language-text\">App.js</code>에서 <code class=\"language-text\">import</code>해서 사용하면 된다.</p>","frontmatter":{"path":"/posts/TIL/9","title":"[MonoRepo] lerna? yarn workspace? 크게 개념만 잡아보기","date":"January 23, 2020"}}},"pageContext":{}}}